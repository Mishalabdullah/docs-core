---
title: 'AWS Bedrock Knowledge Bases'
description: 'Connect your LLMs to organizational data using AWS Bedrock Knowledge Bases through Portkey'
---

AWS Bedrock Knowledge Bases enables you to give foundation models access to your company's private data sources, delivering more relevant, accurate, and customized responses through Retrieval Augmented Generation (RAG).

With Portkey's integration, you can seamlessly connect to AWS Bedrock Knowledge Bases while gaining enterprise features like observability, caching, and reliability - all through a unified API that simplifies authentication.

## What is AWS Bedrock Knowledge Bases?

AWS Bedrock Knowledge Bases is a fully managed service that implements the entire RAG workflow - from data ingestion to retrieval and prompt augmentation. It allows you to:

- **Connect to Multiple Data Sources**: Automatically fetch data from Amazon S3, Confluence, Salesforce, SharePoint, and more.
- **Managed Vector Storage**: Store embeddings in supported vector databases like Amazon Aurora, OpenSearch, Neptune, MongoDB, Pinecone, or Redis.
- **Advanced Retrieval**: Use semantic search and filtering for accurate information retrieval.
- **Source Attribution**: All retrieved information includes citations to improve transparency and minimize hallucinations.

## Prerequisites

Before integrating AWS Bedrock Knowledge Bases with Portkey, ensure you have:

1.  **AWS Account** with Bedrock access enabled.
2.  **AWS Bedrock Knowledge Base** created and configured in a supported region.
3.  **Portkey Account** with an API key.
4.  **AWS Credentials** with permissions to access Bedrock Knowledge Bases, configured in Portkey.

## Setup Guide

### Step 1: Create AWS Bedrock Knowledge Base

First, set up your knowledge base in the AWS console and note down your **Knowledge Base ID** (e.g., `ABC123XYZ`). You will need this for API calls.

### Step 2: Configure AWS Credentials in Portkey

You need to connect your AWS account to Portkey. This allows Portkey to make authenticated requests to AWS on your behalf.

<Steps>
<Step title="Create an Integration">
Navigate to the [Integrations](https://app.portkey.ai/integrations) section on Portkey's Sidebar. This is where you'll connect your LLM providers.

1. Find **Bedrock** and click **Connect**.
2. In the "Create New Integration" window:
   - Enter a **Name** for reference (e.g., `aws-bedrock-prod`).
   - Enter a **Slug** for the integration (e.g., `aws-bedrock-prod`).
   - Enter your **AWS Access Key ID**, **Secret Access Key**, and **Default Region**.
3. Click **Next Step**.

<Frame>
<img src="/images/product/model-catalog/integrations-page.png" width="500"/>
</Frame>

<Note>
The **Slug** you create here will be used as the `virtual_key` in your Portkey client initialization.
</Note>
</Step>

<Step title="Configure Models">

On the model provisioning page:
- Leave all models selected (or customize).
- Toggle "Automatically enable new models" if desired.

Click **Create Integration** to complete the integration.

</Step>
</Steps>

### Step 3: Querying Your Knowledge Base with Portkey

To query an AWS Bedrock Knowledge Base, you use Portkey's `post` method. This acts as a proxy, sending a signed request directly to the AWS `retrieve` API endpoint. Portkey handles the complex AWS Signature Version 4 authentication process for you.

The target AWS API endpoint for retrieval is `POST /knowledgebases/{knowledgeBaseId}/retrieve`.

#### 1. Initialize the Portkey Client

You must initialize the client with your Portkey API Key and the `virtual_key`, which is the slug of the Bedrock AI Provider you configured in Step 2.

<Tabs>
<Tab title="Python SDK">
```python
from portkey_ai import Portkey

# Initialize the client
# The virtual_key points to your AWS Bedrock provider configured in Portkey
portkey = Portkey(
    api_key="YOUR_PORTKEY_API_KEY",
    virtual_key="your-bedrock-provider-slug" # e.g., "aws-bedrock-prod"
)
```
</Tab>
<Tab title="NodeJS SDK">
```javascript
import Portkey from 'portkey-ai';

// Initialize the client
// The virtualKey points to your AWS Bedrock provider configured in Portkey
const portkey = new Portkey({
    apiKey: "YOUR_PORTKEY_API_KEY",
    virtualKey: "your-bedrock-provider-slug" // e.g., "aws-bedrock-prod"
});
```
</Tab>
</Tabs>

#### 2. Make the Retrieval Request

Now, use the `post` method to make a request to the Bedrock Knowledge Base `retrieve` endpoint. You need to provide the `path` and the `body` of the request.

<Tabs>
<Tab title="Python SDK">

```python
from portkey_ai import Portkey

portkey = Portkey(
    api_key="YOUR_PORTKEY_API_KEY",
    virtual_key="your-bedrock-provider-slug",
    custom_host="your-bedrock-agent-runtime-url"
)

# Your Knowledge Base ID from the AWS console
knowledge_base_id = "YOUR_KNOWLEDGE_BASE_ID"
query = "What is our company's remote work policy?"


response = portkey.post(
    url=f"/knowledgebases/{knowledge_base_id}/retrieve",
    retrievalQuery={
        "text": query
    }
)
    # The response contains the retrieved chunks
print(response)
```

</Tab>
<Tab title="NodeJS SDK">

```javascript
import Portkey from 'portkey-ai';

const portkey = new Portkey({
    apiKey: "YOUR_PORTKEY_API_KEY",
    virtualKey: "your-bedrock-provider-slug",
    customHost: "your-bedrock-agent-runtime-url"
});

async function queryKnowledgeBase() {
    // Your Knowledge Base ID from the AWS console
    const knowledgeBaseId = "YOUR_KNOWLEDGE_BASE_ID";
    const query = "What is our company's remote work policy?";

    try {
        // Construct the API path and request body
        const response = portkey.post(
            `/knowledgebases/${knowledgeBaseId}/retrieve`,
            {
                retrievalQuery: {
                    text: query
                }
            }
        )

        // The response contains the retrieved chunks
        console.log(response);

    } catch (error) {
        console.error('Error querying knowledge base:', error);
        throw error;
    }
}

queryKnowledgeBase();
```

</Tab>
</Tabs>

## Next Steps

Now that you can retrieve data from your knowledge base, you can build a full RAG application.
- Explore [Portkey Observability](/product/observability) to monitor your RAG pipeline.
- Set up [Guardrails](/product/guardrails) to ensure safe and compliant responses.
- Implement [Prompt Management](/product/prompt-library) for your RAG prompts.
- Configure [Fallbacks](/product/ai-gateway/fallbacks) for high availability.

<Note>
For enterprise support with your AWS Bedrock integration, contact our [enterprise team](https://calendly.com/portkey-ai).
</Note>
